<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Title -->
    <title>WorkIndia Task</title>
    <!-- Bootstrap for UI -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <body>
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
          <div class="container-fluid">
            <!-- NavBar Title -->
            <a class="navbar-brand" href="/">WorkIndia</a> 
            <button
              class="navbar-toggler"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                <!-- Home -->
                  <a class="nav-link active" aria-current="page" href="/">Home</a> 
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="/about">About</a>
                </li>
              </ul>
              <div class="d-flex" role="search">
                <!-- <input
                  class="form-control me-2"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                /> -->
                <!-- Login and SignUp buttons -->
                <a href="/registeradmin"><button class="btn btn-outline-success mx-2" type="submit">Admin Register</button></a>
                <a href="/login"><button class="btn btn-outline-success mx-2" type="submit">Login</button></a>
                <a href="/signup"><button class="btn btn-outline-success mx-2" type="submit">SignUp</button></a>
                </div>
            </div>
          </div>
        </nav>
    
    <!-- Notes Template - Card -->
    <div class="container"> <!-- Padding -->

    <!-- Adding Notes - Form-->
    <h1 class="text-center my-4">Add a Match</h1>
    <div>
        <div class="mb-3">
          <label for="team1" class="form-label">Team 1</label>
          <input type="text" class="form-control" id="team1">
          <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
        </div>
        <div class="mb-3">
        <label for="team2" class="form-label">Team 2</label>
        <input type="text" class="form-control" id="team2">
        <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
      </div>
      <div class="mb-3">
        <label for="date" class="form-label">Date</label>
        <input type="text" class="form-control" id="date">
        <!-- <div id="emailHelp" class="form-text">We'll never share your email with anyone else.</div> -->
      </div>
        <div class="mb-3">
          <label for="venue" class="form-label">Venue</label>
          <textarea type="text" class="form-control" id="venue"></textarea>
        </div>
        <!-- Submit Button -->
        <button id = "submit" type="submit" class="btn btn-primary">Submit</button>
        <button id = "matchschedule" type="matchschedule" class="btn btn-primary">Match Schedules</button>
    </div>


    <h1 class="text-center my-4">Matches:</h1>
    <div class="row mynotes">  
        <!--  Note1  -->
        <!-- <div class="card mx-2" style="width: 18rem;">
            <div class="card-body">
            <h5 class="card-title">Card title</h5>
            <h6 class="card-subtitle mb-2 text-body-secondary">Card subtitle</h6>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            <a href="#" class="card-link">Card link</a>
            <a href="#" class="card-link">Another link</a>
            </div>
        </div>

        <div class="card mx-2" style="width: 18rem;">
            <div class="card-body">
            <h5 class="card-title">Card title</h5>
            <h6 class="card-subtitle mb-2 text-body-secondary">Card subtitle</h6>
            <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            <a href="#" class="card-link">Delete</a>
            <a href="#" class="card-link">Another link</a>
            </div>
        </div> -->
    </div>
</div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>

    <!-- Fetching Notes -->
    <script>

    // Example POST method implementation:
      // Example POST method implementation:
async function postData(url = "", data = {}) {
  // Default options are marked with *
  const response = await fetch(url, {
    method: "POST", // *GET, POST, PUT, DELETE, etc.
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data),
  });
  let rdata = await response.json();
  return rdata;
}

// // Modify the deleteNote function
// async function deleteNote(title) {
//   let email = JSON.parse(localStorage.getItem("user"))?.email;
//   // Ask for user confirmation
//   const confirmDelete = window.confirm("Are you sure you want to delete this note?");

//   if (!confirmDelete) {
//     return;
//   }

//   const resp = await postData("/deletenote", { email, title });

//   if (resp.success) {
//     alert("Note Deleted!");
//     // Optionally, you can refresh the notes list or perform any other necessary actions.
//   } else {
//     alert("Note deletion failed.");
//   }
// }



// Fetch Match 
// document.addEventListener("DOMContentLoaded", function () {
//   const matchScheduleButton = document.getElementById("matchschedule");
//   const noteContainer = document.querySelector(".mynotes");

//   matchScheduleButton.addEventListener("click", function () {
//     // Fetch data from your server's endpoint
//     fetch("/matchschedule")
//       .then((response) => response.json())
//       .then((data) => {
//         if (data.success) {
//           const matchData = data.matches;

//           // Clear previous notes if any
//           noteContainer.innerHTML = "";

//           // Iterate through the match data and create HTML elements
//           matchData.forEach((element) => {
//             let note = `
//               <div class="card mx-2" style="width: 18rem;">
//                 <div class="card-body">
//                   <h5 class="card-title">Team 1: ${element.team_1}</h5>
//                   <h5 class="card-title">Team 2: ${element.team_2}</h5>
//                   <h5 class="card-title">Date: ${element.date}</h5>
//                   <h5 class="card-title">Venue: ${element.venue}</h5>
//                 </div>
//               </div>`;
//             noteContainer.innerHTML += note;
//           });
//         } else {
//           alert("Failed to fetch match schedules.");
//         }
//       })
//       .catch((error) => {
//         console.error("Error fetching match schedules:", error);
//         alert("An error occurred while fetching match schedules.");
//       });
//   });
// });






        // // Fetch all matched - from API in index.js POST method
        // let email = JSON.parse(localStorage.getItem("user"))?.email
    const matchScheduleButton = document.getElementById("matchschedule");
    
    let noteContainer = document.querySelector(".mynotes");
    noteContainer.innerHTML = " "
    const matches = postData("/matchschedules", { email: user.email }); // Sending POST req to API to fetch match

  // Populate the notes
  matches.then((matches) => {
    console.log("Matches", matches.nomatchestes);

    // let noteContainer = document.querySelector(".mynotes");
    matches.matches.forEach((element) => {
      let match = `
        <div class="card mx-2" style="width: 18rem;">
            <div class="card-body">
                <h5 class="card-title">${element.team1}</h5>
                <h5 class="card-title">${element.team2}</h5>
                <h5 class="card-title">${element.date}</h5>
                <h5 class="card-title">${element.venue}</h5>
            </div>
        </div>`;
        //  <a href="#" class="card-link" onclick="deleteNote('${element.title}')">Delete</a>
      noteContainer.innerHTML += match;
    });
  });



// fetchnotes()


        // Adding a note
        let submit = document.getElementById("submit") //get the element by giving its id
        submit.addEventListener("click",async()=>{
            let title = document.getElementById("title").value
            let desc = document.getElementById("desc").value
            let email = JSON.parse(localStorage.getItem("user"))?.email
            console.log("Submitting this data:", title , desc , email) 
            // console.log(title)
            let resp = await postData("/addnote", { title,desc, email });
            console.log(resp)
            if (resp.success) {
          alert("Note Created!");
          document.getElementById("title").value = ""; //Making the title and desc areas blank after Creating a note
          document.getElementById("desc").value = "";
          // fetchnotes( )
        }

        })
    </script>

  </body>
</html>
